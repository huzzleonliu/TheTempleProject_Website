# Review and Rename

`review-and-rename` 是一个基于 Rust + `eframe/egui` 的桌面应用，用于快速浏览图像 / 文档资源，并按预览顺序批量重命名文件。程序的目标是协助内容审核与整理工作，让用户在一个窗口内完成“查看、排序、重命名”三步操作。

## 功能概览

- **目录浏览**：通过 `File > Open Directory` 选择资源目录，左侧列表即时展示其中的图片、文本（含 PDF / DOCX）等文件，支持拖拽调整顺序。
- **懒加载预览**：选择文件后才读取内容，提升大型目录的加载响应。右侧预览区会根据类型展示图片缩略图或文本内容，PDF / DOCX 以提取文字的方式预览。
- **批量重命名**：底部工具栏提供“按预览顺序重命名”按钮，支持自定义起始编号并按最大位数自动补零（例如 `01.png`、`02.png`）。
- **日志输出**：在终端实时打印加载、预览、重命名的关键步骤，方便排查问题。

## 运行方式

```bash
cargo run --release
```

启动后，如需加载特定字体以正确显示中文，可在系统安装常见 CJK 字体，或通过环境变量 `EGUI_FONT_PATH` 配置字体文件。

## 重命名规则

- 仅对当前列表中顺序排列的文件生效。
- 起始值默认为 `1`，可在底部输入框中修改并提交。
- 自动计算最大编号长度，对所有输出名称进行零填充，保持对齐。
- 重命名采取“两段式”策略，先写入临时文件名（避免冲突），再按目标名称写回。

## 依赖与源码结构

- `src/main.rs`：应用入口，配置字体并启动 `eframe`.
- `src/main_window.rs`：主要 UI 逻辑，包括文件列表、预览面板、拖拽排序、重命名实现。
- `src/utils.rs`：纹理加载、棋盘背景绘制等辅助工具。
- `Cargo.toml` 中的关键依赖：
  - `eframe` / `egui`：桌面 UI 框架。
  - `image`：读取图像文件。
  - `rfd`：原生文件/目录选择对话框。
  - `egui_dnd`：列表拖拽排序组件。
  - `pdf-extract`：PDF 文本提取。
  - `docx-lite`：DOCX 文本文档解析。

## 常见问题

- **文字显示为方块**：请确保本机安装了中文字体，或通过 `EGUI_FONT_PATH` 指定字体文件（程序启动时会尝试加载）。
- **加载缓慢**：程序仅在点击文件后读取内容，如需排查可观察终端日志，确认是否是文件过大或解析失败。
- **重命名冲突**：遇到目标名称已存在时会中断，并在状态栏提示，需手动处理冲突文件后重新执行。

## 开发 / 调试

- 使用 `cargo fmt` / `cargo clippy` 保持代码风格与质量。
- 可通过 `RUST_LOG` 或直接查看终端输出获取调试信息。
- UI 结构采用 `egui` 即时模式设计，调整面板布局或交互时建议从 `MainWindow::show` 与相关子函数着手。


